services:
  legen:
    build:
      context: .
      args:
        PYTORCH_INSTALL_CUDA: ${PYTORCH_INSTALL_CUDA:-true}
        PYTORCH_CUDA_INDEX_URL: ${PYTORCH_CUDA_INDEX_URL:-https://download.pytorch.org/whl/cu121}
    image: legen:local
    volumes:
      - ./data:/data
      - ./downloads:/app/downloads
      - ./softsubs_m:/app/softsubs_m
      - ./hardsubs_m:/app/hardsubs_m
    environment:
      NVIDIA_VISIBLE_DEVICES: ${NVIDIA_VISIBLE_DEVICES:-all}
      NVIDIA_DRIVER_CAPABILITIES: ${NVIDIA_DRIVER_CAPABILITIES:-compute,video,utility}
    command: ["--help"]